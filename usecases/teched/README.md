Originally sourced from 3384-ecc-extension.
